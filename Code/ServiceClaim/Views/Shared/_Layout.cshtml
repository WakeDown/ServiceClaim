@using System.Configuration
@using System.Data.SqlClient
@using ServiceClaim.Objects
<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ViewBag.Title</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" />
    @Styles.Render("~/Content/css")
</head>
<body>
    @Scripts.Render("~/bundles/modernizr")
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js"></script>
    @Scripts.Render("~/bundles/jquery")
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
    @Scripts.Render("~/bundles/bootstrap")
    @Scripts.Render("~/bundles/common")
<div class="navbar navbar-default navbar-fixed-top">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="~/">
                <img class="headLogo" src="~/Content/images/logo-unit.png" alt=""/>
                <div class="h5"><strong>ЮНИТ</strong>&nbsp;<span class="h6">Сервис</span></div>
            </a>
        </div>
        <div class="navbar-collapse collapse navbar-default">
            <ul class="nav navbar-nav">
                <li><a href="@Url.Action("New", "Claim")" class="nav-btn-primary"><i class="fa fa-plus-circle"></i> Новая</a></li>
                <li><a href="@Url.Action("List", "Claim")"><i class="fa fa-list"></i> Заявки</a></li>
                @if (ViewBag.CurUser.HasAccess(AdGroup.ServiceClaimClientAccess, AdGroup.ServiceClaimContractorAccess, AdGroup.ServiceClaimClassifier))
                {
                <li><a href="@Url.Action("Planing", "ServiceIssuePlan")"><i class="fa fa-plane"></i> Планирование поездки</a></li>
                
                <li>
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-cog fa-fw"></i>Настройки <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        <li><a href="@Url.Action("List", "Classifier")">Классификатор</a></li>
                        <li><a href="@Url.Action("List", "ClientAccess")">Доступы клиентов</a></li>
                        <li><a href="@Url.Action("List", "ContractorAccess")">Доступы подрядчиков</a></li>
                    </ul>
                </li>
                }
                @if ((DateTime.Now.Month == 1 && DateTime.Now.Day <= 15) || (DateTime.Now.Month == 12 && DateTime.Now.Day >= 20))
                {
                    <li>
                        <a href="#" style="color: red; font-size: 14pt" target="_blank">
                            <i class="fa fa-tree" style="color: green"></i> С @(DateTime.Now.Month == 12 ? "наступающим " : String.Empty)новым @(DateTime.Now.Month == 1 ? DateTime.Now.Year + " " : String.Empty)годом! <i class="fa fa-tree" style="color: green"></i>
                        </a>
                    </li>
                }
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li class="navbar-text">Вы вошли как <strong id="userName">@ViewBag.CurUser.DisplayName</strong></li>
            </ul>
        </div>
    </div>
</div>
<div class="container body-content">
    @if (!String.IsNullOrEmpty(ConfigurationManager.AppSettings["Environment"]))
    {
        <blockquote class="bg-warning text-sm">
            @ConfigurationManager.AppSettings["Environment"]<br/>
            @ConfigurationManager.AppSettings["OdataServiceUri"]
            @foreach (ConnectionStringSettings cs in ConfigurationManager.ConnectionStrings)
            {
                
                    var conn = new SqlConnection(cs.ConnectionString);
                     @(conn.DataSource.Contains("usql-1") ? "text-danger text-lg bold" : String.Empty)
                     bool isProduction = conn.DataSource.Contains("usql-1");

                <div class="@(isProduction ? "text-danger text-lg bold" : String.Empty)"><i class="@(isProduction ? "fa fa-warning text-danger" : String.Empty)"></i>@conn.DataSource - @conn.Database</div>
            }
        </blockquote>
    }
    @RenderBody()
    <hr/>
    <footer>
        <div class="pull-left">
            <h5>
                2015 @if (DateTime.Now.Year > 2015)
                     {
                         @String.Format("- {0}", DateTime.Now.Year)
                     }
                &copy; UN1T
                <br/>
                <small>v&nbsp;1.0</small>
            </h5>
        </div>
        <div class="pull-right">
            <h5><small><a href='http://support.unitgroup.ru' target="_blank">Техподдержка</a></small></h5>
        </div>
    </footer>
</div>
@RenderSection("scripts", required: false)
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-72701828-1', 'auto');
      ga('send', 'pageview');
    </script>
</body>
</html>
